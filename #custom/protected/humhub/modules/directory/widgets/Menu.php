<?php

/**
 * @link https://www.humhub.org/
 * @copyright Copyright (c) 2015 HumHub GmbH & Co. KG
 * @license https://www.humhub.com/licences
 */

namespace humhub\modules\directory\widgets;

use Yii;
use humhub\modules\ui\menu\MenuLink;
use humhub\modules\directory\Module;
use humhub\modules\ui\menu\widgets\LeftNavigation;

/**
 * Directory module navigation
 *
 * @since 0.21
 * @author Luke
 */
class Menu extends LeftNavigation
{
    /**
     * @inheritdoc
     */
    public function init()
    {
        /** @var Module $module */
        $module = Yii::$app->getModule('directory');

        $this->panelTitle = Yii::t('DirectoryModule.base', '<strong>Поиск</strong>');

        $this->addEntry(new MenuLink([
            'id' => 'directory-members',
            'icon' => false,
            'label' => Yii::t('DirectoryModule.custom', '<div class="item"><div class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M20 10C20 4.486 15.514 0 10 0C7.40681 0 4.94846 0.988381 3.0779 2.78302C2.84172 3.00963 2.83398 3.38471 3.06051 3.62088C3.28704 3.85705 3.6622 3.86471 3.89837 3.63826C5.54723 2.05641 7.71418 1.1852 10 1.1852C14.8606 1.1852 18.8149 5.13952 18.8149 10C18.8149 12.2104 17.9924 14.3249 16.4989 15.9541C14.8324 17.7721 12.4636 18.8149 10 18.8149C7.6365 18.8149 5.36012 17.855 3.7074 16.1716C3.71719 16.1292 3.7281 16.0873 3.73884 16.0454C3.74738 16.0119 3.75528 15.9783 3.76437 15.9451C3.77827 15.8945 3.79376 15.8447 3.80901 15.7947C3.81809 15.7651 3.82631 15.7351 3.83579 15.7057C3.85428 15.6484 3.87443 15.592 3.89466 15.5356C3.90232 15.5142 3.9092 15.4925 3.9171 15.4713C3.9747 15.3162 4.03878 15.1646 4.10886 15.0167C4.11937 14.9946 4.13083 14.9731 4.14158 14.9511C4.1667 14.8998 4.19183 14.8484 4.21846 14.798C4.23252 14.7714 4.24761 14.7454 4.26215 14.719C4.28672 14.6742 4.31106 14.6292 4.33674 14.5852C4.35325 14.5568 4.37087 14.5292 4.38786 14.5011C4.41283 14.46 4.43764 14.4187 4.46356 14.3783C4.48205 14.3495 4.5014 14.3215 4.52037 14.2932C4.54628 14.2544 4.57196 14.2156 4.59875 14.1775C4.6189 14.1488 4.63992 14.1209 4.66062 14.0926C4.68748 14.056 4.71419 14.0192 4.74184 13.9833C4.76357 13.955 4.78617 13.9273 4.80845 13.8995C4.83634 13.8647 4.86416 13.8297 4.89284 13.7955C4.91599 13.7679 4.93985 13.7409 4.96355 13.7138C4.99255 13.6805 5.02155 13.6472 5.05134 13.6146C5.07583 13.5877 5.10096 13.5616 5.12593 13.5352C5.15611 13.5034 5.18629 13.4717 5.21711 13.4406C5.24287 13.4147 5.2691 13.3894 5.29525 13.364C5.32654 13.3338 5.35791 13.3035 5.38991 13.274C5.41686 13.2491 5.44419 13.2247 5.47153 13.2003C5.50385 13.1715 5.5364 13.1429 5.56935 13.1148C5.5974 13.091 5.62585 13.0675 5.65445 13.0442C5.68787 13.0169 5.72145 12.9898 5.75543 12.9633C5.78459 12.9405 5.81406 12.9182 5.84361 12.896C5.87806 12.8702 5.91267 12.8447 5.94767 12.8197C5.97793 12.7981 6.00835 12.7768 6.03901 12.7558C6.07441 12.7315 6.11004 12.7077 6.14591 12.6842C6.17712 12.6638 6.20849 12.6438 6.2401 12.6239C6.27644 12.6012 6.31311 12.5789 6.35001 12.5569C6.38209 12.5379 6.41432 12.5189 6.4468 12.5005C6.48409 12.4792 6.52178 12.4586 6.55963 12.4382C6.59258 12.4205 6.62561 12.4028 6.65887 12.3857C6.69711 12.366 6.73575 12.3471 6.77447 12.3283C6.80821 12.3119 6.84195 12.2955 6.876 12.2798C6.91527 12.2617 6.95486 12.2443 6.99452 12.2271C7.02889 12.2122 7.06318 12.1972 7.09779 12.183C7.13809 12.1665 7.1787 12.1508 7.21939 12.1352C7.25432 12.1218 7.28908 12.1083 7.32432 12.0956C7.36557 12.0806 7.40729 12.0667 7.44893 12.0527C7.48425 12.0409 7.51949 12.0288 7.55512 12.0176C7.59739 12.0043 7.64014 11.9921 7.68289 11.9798C7.71852 11.9695 7.75408 11.9589 7.79003 11.9493C7.83357 11.9377 7.8775 11.9273 7.92143 11.9166C7.95714 11.908 7.99278 11.8989 8.02873 11.8909C8.07361 11.881 8.11904 11.8723 8.16432 11.8635C8.19987 11.8565 8.23527 11.849 8.27106 11.8426C8.31776 11.8344 8.36493 11.8276 8.41194 11.8205C8.44687 11.8152 8.48156 11.8093 8.51664 11.8047C8.56618 11.7982 8.61627 11.7933 8.66621 11.788C8.69924 11.7845 8.73211 11.7802 8.76529 11.7773C8.82076 11.7724 8.87678 11.7694 8.93264 11.7661C8.96069 11.7644 8.98859 11.7619 9.01671 11.7606C9.10094 11.7569 9.18557 11.7549 9.27066 11.7549H10.7295C12.4417 11.7549 14.0489 12.5142 15.139 13.838C15.347 14.0907 15.7205 14.1268 15.9732 13.9188C16.2258 13.7108 16.2619 13.3373 16.0539 13.0847C15.1248 11.9563 13.8842 11.1683 12.5076 10.8021C13.291 10.108 13.7861 9.09541 13.7861 7.96892C13.7861 5.8813 12.0877 4.18282 10 4.18282C7.91234 4.18282 6.21394 5.88122 6.21394 7.96892C6.21394 9.09541 6.70904 10.1079 7.49238 10.802C7.47295 10.8072 7.45335 10.8121 7.43391 10.8174C7.35269 10.8398 7.2721 10.8637 7.19205 10.889C7.18226 10.8921 7.17222 10.8948 7.16242 10.8979C7.07266 10.9266 6.98385 10.9574 6.8956 10.9896C6.8681 10.9996 6.84108 11.0107 6.81374 11.0211C6.75329 11.0441 6.69293 11.0674 6.63327 11.0922C6.60016 11.1058 6.56753 11.1203 6.53466 11.1345C6.48133 11.1576 6.42807 11.1809 6.37545 11.2052C6.34108 11.2211 6.3071 11.2375 6.27305 11.2539C6.22232 11.2784 6.17199 11.3034 6.12189 11.329C6.08808 11.3464 6.05434 11.3639 6.02084 11.3818C5.97066 11.4086 5.92096 11.4362 5.8715 11.4642C5.83958 11.4823 5.80758 11.5003 5.77597 11.5188C5.72398 11.5494 5.6727 11.581 5.6215 11.6129C5.59361 11.6303 5.56548 11.6472 5.53783 11.665C5.4743 11.7059 5.41164 11.7481 5.34954 11.791C5.33531 11.8008 5.32078 11.8101 5.30663 11.82C5.23078 11.8733 5.15611 11.9281 5.08247 11.9844C5.06114 12.0007 5.04043 12.0178 5.01926 12.0343C4.96743 12.0749 4.91575 12.1158 4.86502 12.1578C4.83808 12.1802 4.81169 12.2033 4.78514 12.226C4.74105 12.2637 4.6972 12.3016 4.65414 12.3404C4.62632 12.3655 4.59899 12.3909 4.57157 12.4164C4.53064 12.4545 4.49003 12.493 4.44997 12.5321C4.42279 12.5587 4.39576 12.5854 4.36898 12.6124C4.32939 12.6524 4.29044 12.6929 4.25188 12.7338C4.22636 12.7609 4.20084 12.7877 4.17579 12.8152C4.13589 12.8589 4.09685 12.9035 4.05806 12.9482C4.03586 12.9738 4.01326 12.9991 3.99137 13.0251C3.94562 13.0794 3.90098 13.135 3.85689 13.1908C3.8433 13.2081 3.82916 13.2247 3.81572 13.2421C3.75876 13.3156 3.70329 13.3904 3.64924 13.4663C3.63486 13.4865 3.62127 13.5073 3.60713 13.5277C3.56794 13.584 3.52906 13.6407 3.49153 13.6983C3.47257 13.7274 3.4544 13.7571 3.43583 13.7865C3.4043 13.8365 3.37301 13.8867 3.34275 13.9376C3.32339 13.9701 3.30466 14.0029 3.28586 14.0358C3.25765 14.085 3.22992 14.1346 3.20289 14.1846C3.18448 14.2187 3.16639 14.2529 3.14853 14.2873C3.12238 14.3377 3.09694 14.3886 3.07205 14.4397C3.05522 14.4742 3.03847 14.5086 3.02219 14.5433C2.99706 14.5972 2.97297 14.6516 2.94918 14.7063C2.93496 14.739 2.92034 14.7714 2.90652 14.8045C2.87989 14.8682 2.85476 14.9328 2.82995 14.9976C2.82055 15.0221 2.81051 15.0462 2.80143 15.0709C2.80008 15.0745 2.79858 15.078 2.79724 15.0816C1.75149 13.602 1.1852 11.834 1.1852 10C1.1852 9.67276 0.919876 9.40744 0.592602 9.40744C0.265328 9.40744 0 9.67276 0 10C0 12.5078 0.93315 14.9067 2.62744 16.755C4.51792 18.8172 7.20517 20 9.99996 20C12.7949 20 15.4821 18.8172 17.3726 16.7549L17.373 16.7544C19.0671 14.9062 20 12.5075 20 10ZM10 5.36803C11.4341 5.36803 12.6009 6.53474 12.6009 7.96892C12.6009 9.40309 11.4342 10.5698 10 10.5698C8.56586 10.5698 7.39915 9.40309 7.39915 7.96892C7.39915 6.53474 8.56586 5.36803 10 5.36803Z" fill="#045269"/></svg></div> Участники</div>'),
            'url' => ['/directory/directory/members'],
            'sortOrder' => 200,
            'isActive' => MenuLink::isActiveState('directory', 'directory', 'members')
        ]));

        $this->addEntry(new MenuLink([
            'id' => 'directory-spaces',
            'icon' => false,
            'label' => Yii::t('DirectoryModule.custom', '<div class="item"><div class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="20" viewBox="0 0 32 20" fill="none"><path d="M27.2421 8.80025C28.1645 8.15207 28.7753 7.07385 28.7753 5.85852C28.7753 3.87036 27.1673 2.26239 25.1792 2.26239C23.191 2.26239 21.583 3.87036 21.583 5.85852C21.583 7.07385 22.1876 8.15207 23.1162 8.80025C22.3247 9.07448 21.6017 9.49829 20.991 10.0467C20.1496 9.33001 19.1586 8.78155 18.0742 8.45746C19.3892 7.65971 20.2742 6.20754 20.2742 4.55594C20.2742 2.03802 18.2362 0 15.7183 0C13.2004 0 11.1624 2.04425 11.1624 4.55594C11.1624 6.20754 12.0411 7.65971 13.3624 8.45746C12.2904 8.78155 11.3119 9.32378 10.4768 10.028C9.866 9.49205 9.1555 9.07448 8.37644 8.80648C9.29885 8.15831 9.90963 7.08009 9.90963 5.86476C9.90963 3.8766 8.30165 2.26862 6.31349 2.26862C4.32534 2.26862 2.71736 3.8766 2.71736 5.86476C2.71736 7.08009 3.32191 8.15831 4.25055 8.80648C1.77625 9.66033 0 12.01 0 14.771V15.1823C0 15.1948 0.0124649 15.2072 0.0249299 15.2072H7.64724C7.60361 15.55 7.57868 15.9053 7.57868 16.2605V16.6843C7.57868 18.5167 9.06201 20 10.8944 20H20.5547C22.387 20 23.8704 18.5167 23.8704 16.6843V16.2605C23.8704 15.9053 23.8454 15.55 23.8018 15.2072H31.474C31.4864 15.2072 31.4989 15.1948 31.4989 15.1823V14.771C31.4864 12.0037 29.7164 9.6541 27.2421 8.80025ZM22.5802 5.85229C22.5802 4.41882 23.7457 3.25335 25.1792 3.25335C26.6126 3.25335 27.7781 4.41882 27.7781 5.85229C27.7781 7.26706 26.6376 8.42007 25.229 8.45123C25.2103 8.45123 25.1979 8.45123 25.1792 8.45123C25.1605 8.45123 25.148 8.45123 25.1293 8.45123C23.7146 8.4263 22.5802 7.27329 22.5802 5.85229ZM12.1471 4.55594C12.1471 2.59271 13.7426 0.997195 15.7058 0.997195C17.6691 0.997195 19.2646 2.59271 19.2646 4.55594C19.2646 6.45061 17.775 8.00249 15.9115 8.10845C15.8429 8.10845 15.7744 8.10845 15.7058 8.10845C15.6373 8.10845 15.5687 8.10845 15.5002 8.10845C13.6366 8.00249 12.1471 6.45061 12.1471 4.55594ZM3.69586 5.85229C3.69586 4.41882 4.86133 3.25335 6.2948 3.25335C7.72826 3.25335 8.89374 4.41882 8.89374 5.85229C8.89374 7.26706 7.75319 8.42007 6.34466 8.45123C6.32596 8.45123 6.31349 8.45123 6.2948 8.45123C6.2761 8.45123 6.26363 8.45123 6.24494 8.45123C4.8364 8.4263 3.69586 7.27329 3.69586 5.85229ZM7.82175 14.2038H1.00966C1.29012 11.5488 3.53381 9.46712 6.2574 9.44843C6.26987 9.44843 6.28233 9.44843 6.2948 9.44843C6.30726 9.44843 6.31973 9.44843 6.33219 9.44843C7.62854 9.45466 8.81271 9.93456 9.72889 10.7136C8.83141 11.6859 8.16454 12.8825 7.82175 14.2038ZM22.8607 16.6843C22.8607 17.962 21.8199 19.0028 20.5422 19.0028H10.8819C9.60424 19.0028 8.56341 17.962 8.56341 16.6843V16.2605C8.56341 12.3902 11.6547 9.22406 15.5002 9.11187C15.5687 9.11811 15.6435 9.11811 15.7121 9.11811C15.7806 9.11811 15.8554 9.11811 15.924 9.11187C19.7694 9.22406 22.8607 12.3902 22.8607 16.2605V16.6843ZM23.6024 14.2038C23.2596 12.8888 22.6052 11.7108 21.7139 10.7385C22.6363 9.94079 23.833 9.46089 25.1418 9.44843C25.1543 9.44843 25.1667 9.44843 25.1792 9.44843C25.1916 9.44843 25.2041 9.44843 25.2166 9.44843C27.9402 9.46712 30.1839 11.5488 30.4643 14.2038H23.6024Z" fill="#045269"/></svg></div> Группы</div>'),
            'url' => ['/directory/directory/spaces'],
            'sortOrder' => 300,
            'isActive' => MenuLink::isActiveState('directory', 'directory', 'spaces')
        ]));

        $this->addEntry(new MenuLink([
            'id' => 'directory-spaces',
            'icon' => false,
            'label' => Yii::t('DirectoryModule.custom', '<div class="item"><div class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M8.44827 0C3.78988 0 0 3.78988 0 8.44827C0 13.1067 3.78988 16.8965 8.44827 16.8965C13.1067 16.8965 16.8965 13.1067 16.8965 8.44827C16.8965 3.78988 13.1066 0 8.44827 0ZM8.44827 15.4187C4.60468 15.4187 1.47785 12.2919 1.47785 8.44827C1.47785 4.60468 4.60468 1.47785 8.44827 1.47785C12.2916 1.47785 15.4187 4.60468 15.4187 8.44827C15.4187 12.2919 12.2919 15.4187 8.44827 15.4187Z" fill="#045269"/> <path d="M19.7837 18.7387L14.4142 13.3692C14.1255 13.0805 13.658 13.0805 13.3693 13.3692C13.0807 13.6577 13.0807 14.1256 13.3693 14.4141L18.7388 19.7835C18.8832 19.9278 19.0721 20 19.2612 20C19.4504 20 19.6393 19.9278 19.7837 19.7835C20.0723 19.4951 20.0723 19.0271 19.7837 18.7387Z" fill="#045269"/></svg></div> По слову</div>'),
            'url' => ['/search/search'],
            'sortOrder' => 400,
            'isActive' => MenuLink::isActiveState('search', 'search')
        ]));

        if ($module->isGroupListingEnabled()) {
            /* $this->addEntry(new MenuLink([
                'id' => 'directory-groups',
                'icon' => 'users',
                'label' => Yii::t('DirectoryModule.base', 'Groups'),
                'url' => ['/directory/directory/groups'],
                'sortOrder' => 500,
                'isActive' => MenuLink::isActiveState('directory', 'directory', 'groups')
            ])); */
        }

        if ($module->showUserProfilePosts) {
            /* $this->addEntry(new MenuLink([
                'id' => 'directory-user-posts',
                'icon' => 'commenting ',
                'label' => Yii::t('DirectoryModule.base', 'User profile posts'),
                'url' => ['/directory/directory/user-posts'],
                'sortOrder' => 600,
                'isActive' => MenuLink::isActiveState('directory', 'directory', 'user-posts')
            ])); */
        }

        parent::init();
    }

}
